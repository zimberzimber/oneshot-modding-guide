<!doctype html>
<html>

<head>
	<meta charset="utf-8">

	<title>Modifying Scripts</title>

	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-sulphurpool.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>

	<style>@font-face {
  font-family: 'Terminus TTF';
  src: url('TerminusTTF.ttf') format('truetype');
}

p {
  white-space: pre-wrap;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  color: white;
}


code {
  background: #202746;
  padding: 0 4px;
  margin: 0 -4px;
}

a:link {
  color: #FFFF00;
}

a:visited {
  color: #FFFF00;
}

a:hover {
  color: #FFFF00;
}

a:active {
  color: #FFFF00;
}

.copy-code-block-button {
  position: absolute;
  right: 8px;
}

html,
body {
  height: 100%;
  margin: 0;
  color: #F3F3F3;
}

img,
video {
  max-width: 100%;
}

.layout {
  display: flex;
  height: 100%;
}

.side {
  width: 240px;
  background: #4f2b77;
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
}

.content {
  margin-left: 240px;
  width: 100%;
  height: 100%;
  overflow-y: auto;
  background: #34135A;
  padding: 1rem;
  box-sizing: border-box;
}

ul.navtree {
  padding-left: 20px;
  padding-right: 5px;
}</style>
	<script>const BACKLINK_NAV_DATA = [{"title":"About","path":"/about.html","children":null},{"title":"For Players","path":"/for_players.html","children":null},{"title":"Things to Consider","path":"/things_to_consider.html","children":null},{"title":"Layers","path":"/layers.html","children":[{"title":"Translation","path":"/layers/translation.html","children":null},{"title":"Asset Layer","path":"/layers/asset_layer.html","children":[{"title":"Character Sprite Layout","path":"/layers/asset_layer/character_sprite_layout.html","children":null},{"title":"Light Maps","path":"/layers/asset_layer/light_maps.html","children":null},{"title":"Tileset Layout","path":"/layers/asset_layer/tileset_layout.html","children":null},{"title":"Visual Style Guide","path":"/layers/asset_layer/visual_style_guide.html","children":null}]},{"title":"Editor Layer","path":"/layers/editor_layer.html","children":[{"title":"Common Text","path":"/layers/editor_layer/common_text.html","children":null},{"title":"Init Events","path":"/layers/editor_layer/init_events.html","children":null},{"title":"Wide Map Transfers","path":"/layers/editor_layer/wide_map_transfers.html","children":null},{"title":"Item Combinations","path":"/layers/editor_layer/item_combinations.html","children":null},{"title":"Fast Travel","path":"/layers/editor_layer/fast_travel.html","children":null},{"title":"Footstep SFX","path":"/layers/editor_layer/footstep_sfx.html","children":null}]},{"title":"Script Layer","path":"/layers/script_layer.html","children":[{"title":"Modifying Scripts","path":"/layers/script_layer/modifying_scripts.html","children":null}]},{"title":"Engine Layer","path":"/layers/engine_layer.html","children":[{"title":"Using a Different Engine","path":"/layers/engine_layer/using_a_different_engine.html","children":null}]}]},{"title":"Journal App","path":"/journal_app.html","children":null},{"title":"Save Directory","path":"/save_directory.html","children":null},{"title":"Collaboration & Version Control","path":"/collaboration_&_version_control.html","children":null},{"title":"Quality of Life","path":"/quality_of_life.html","children":[{"title":"Frozen Editor During Playtesting","path":"/quality_of_life/frozen_editor_during_playtesting.html","children":null},{"title":"Closing the Game","path":"/quality_of_life/closing_the_game.html","children":null},{"title":"Debug Mode","path":"/quality_of_life/debug_mode.html","children":null},{"title":"Supplementary Scripts","path":"/quality_of_life/supplementary_scripts.html","children":[{"title":"Noclip","path":"/quality_of_life/supplementary_scripts/noclip.html","children":null},{"title":"Seeing Collisions","path":"/quality_of_life/supplementary_scripts/seeing_collisions.html","children":null},{"title":"Event Labels","path":"/quality_of_life/supplementary_scripts/event_labels.html","children":null},{"title":"Other Event's Self Switches","path":"/quality_of_life/supplementary_scripts/other_event's_self_switches.html","children":null},{"title":"Calling Events","path":"/quality_of_life/supplementary_scripts/calling_events.html","children":null}]},{"title":"Editor Version","path":"/quality_of_life/editor_version.html","children":null}]},{"title":"Distribution","path":"/distribution.html","children":null},{"title":"Resources","path":null,"children":[{"title":"Dialogue Transcript","path":"/resources/dialogue_transcript.html","children":null},{"title":"Fonts","path":"/resources/fonts.html","children":null},{"title":"RMXP Extractor","path":"/resources/rmxp_extractor.html","children":null}]}]</script>
	<script defer>

function normalizeWikilinks() {
	const openNodes = [...BACKLINK_NAV_DATA]
	const linkDictionary = {}
	while (openNodes.length > 0) {
		node = openNodes.pop()

		if (node.path)
			linkDictionary[node.title] = node.path

		if (node.children)
			openNodes.push(...node.children)
	}

	for (const wikilink of document.querySelectorAll("a.wikilink")) {
		const fixedLink = linkDictionary[wikilink.innerText]
		if (fixedLink)
			wikilink.href = fixedLink
	}
}

function buildNavigationTree(data) {
	const ul = document.createElement('ul')
	ul.classList.add("navtree")

	for (const node of data) {
		const li = document.createElement('li')
		li.classList.add("navtree")

		if (node.path) {
			const a = document.createElement('a')
			a.classList.add("navtree")

			a.textContent = node.title;
			a.href = node.path;
			li.appendChild(a);
		} else {
			const span = document.createElement('span')
			span.classList.add("navtree")

			span.textContent = node.title;
			li.appendChild(span)
		}

		if (node.children)
			li.appendChild(buildNavigationTree(node.children))

		ul.appendChild(li)
	}

	return ul;
}


function addCodeBlockCopyButtons() {
	const codeBlocks = document.querySelectorAll("pre.sourceCode")
	for (block of codeBlocks) {
		const button = createCodeBlockCopyButton()
		block.prepend(button)
	}
}

function createCodeBlockCopyButton() {
	const b = document.createElement("button")
	b.type = "button"
	b.className = "copy-code-block-button"
	b.title = "Copy"
	b.onclick = copyCodeBlock
	b.innerText = "copy"
	return b
}

function copyCodeBlock(caller) {
	console.log(caller.target.parentNode)
	g = caller.target.parentNode.querySelector("code")
	const content = caller.target.parentNode.querySelector("code").innerText.replace(/\u00a0/g, " ");
	navigator.clipboard.writeText(content)
}

window.onload = () => {
	hljs.highlightAll()
	normalizeWikilinks()
	addCodeBlockCopyButtons()

	const xd = buildNavigationTree(BACKLINK_NAV_DATA)
	document.querySelector(".side").appendChild(xd)
}</script>
</head>

<body>
	<div class="layout">
		<aside class="side">
		</aside>
		<main class="content">
			<h1>Modifying Scripts</h1>

			<p>The game handles scripts in a slightly different way.
While the editors uses the <code>/Data/Scripts.rxdata</code> file, the game itself reads the <code>/Data/xScripts.rxdata</code> file.
Don’t ask why.</p>
<p>Depending on your approach to scripting, you must take a few steps…</p>
<p>So for the game to load your updated scripts, you must save your changes, delete <code>xScripts.rxdata</code>, make a copy of <code>Scripts.rxdata</code>, and rename it to <code>xScripts.rxdata</code>.</p>
<h2 id="scripting-via-rpg-maker-script-editor">Scripting via RPG Maker Script Editor</h2>
<p>While suboptimal, annoying, and terrible for source control, the setup doesn’t require any additional tools besides RPG Maker.
You can use this method if you don’t intend to delve into scripting too often, like only doing the minor script changes required for some of the <a href="Editor Layer" class="wikilink">Editor Layer</a> parts.</p>
<p>Initially, you will not see the scripts in RPG Maker’s script editor.
Here’s what you must do:</p>
<ul>
<li>Go to the <code>Data</code> folder</li>
<li>Delete <code>Scripts.rxdata</code></li>
<li>Make a copy of <code>xScripts.rxdata</code></li>
<li>Rename the copy to <code>Scripts.rxdata</code></li>
<li>Close the editor if it was open</li>
</ul>
<p>Next time you open the script editor, you’ll see all the scripts.</p>
<p>Now, every modification you make to the scripts <strong>will not automatically apply to the game.</strong>
For the game to see the changes, you must follow these steps <strong>every time you want to apply changes</strong>:</p>
<ul>
<li>Save the project</li>
<li>Go to the <code>Data</code> folder</li>
<li>Delete <code>xScripts.rxdata</code></li>
<li>Make a copy of <code>Scripts.rxdata</code></li>
<li>Rename the copy to <code>xScripts.rxdata</code></li>
<li>Relaunch the game if it was open</li>
</ul>
<p>Next time the game launches, it will have your modified scripts.</p>
<p>You don’t need to worry about packing your scripts with this method.</p>
<h2 id="scripting-the-right-way">Scripting the Right Way</h2>
<p>While more advanced, this setup is one and done, but requires some additional tools and packing the scripts for releases.</p>
<p>Use the <a href="RMXP Extractor" class="wikilink">RMXP Extractor</a> to extract the scripts, which will create the <code>scripts</code> folder with the extracted script files, and a <code>_scripts.txt</code> file.</p>
<p>Then set this as the only RPG Maker script via the editor:</p>
<pre class="embed-ruby"><code>PATH: &quot;vault://Assets/main_override.rb&quot;
TITLE: &quot;Main&quot;</code></pre>
<p>This will read the <code>_scripts.txt</code> file to determine which files are to load from the <code>scripts</code> folder, and in what order.</p>
<p>Now you can read, modify, and create new scripts with your favorite text editing program, instead of being forced to suffer RPG Maker’s awful script editor.
Just make sure you save your changes and relaunch the game for them to take effect.</p>
<p>Any time you add a new script, you must include it in <code>_scripts.txt</code>, and make sure it loads after its dependencies, but after whatever it’s a dependency for.</p>

		</main>
	</div>
</body>

</html>